scale_color_manual(labels = c("children", "adults", "elderly"), values = c("red", "green", "blue"))
geom_line(aes(y = child, color = "red")) +
geom_line(aes(y = adult, color = "green")) +
geom_line(aes(y = elderly, color = "blue")) +
labs(x = "Year", y = "Cases [thousands]", color = "Legend") +
scale_color_manual(labels = c("children", "adults", "elderly"), values = c("red", "green", "blue"))
gruped_by_age_and_year
ggplot(gruped_by_age_and_year, aes(year)) +
geom_line(aes(y = child_cases, color = "red")) +
geom_line(aes(y = adult_cases, color = "green")) +
geom_line(aes(y = elderly_cases, color = "blue")) +
labs(x = "Year", y = "Cases [thousands]", color = "Legend") +
scale_color_manual(labels = c("children", "adults", "elderly"), values = c("red", "green", "blue"))
gruped_by_age_country_year <- gruped_by_age_and_year %>%
group_by(country, year) %>%
summarize(child_cases=sum(child_cases), adult_cases=sum(adult_cases), elderly_cases=sum(elderly_cases)) %>%
group_by(country)
gruped_by_age_country_year <- gruped_by_age_and_year %>%
group_by(country, year) %>%
summarize(child_cases=sum(child_cases), adult_cases=sum(adult_cases), elderly_cases=sum(elderly_cases)) %>%
ungroup() %>%
group_by(country)
gruped_by_age_country_year <- gruped_by_age_and_year %>%
group_by(country, year) %>%
summarize(child_cases=sum(child_cases), adult_cases=sum(adult_cases), elderly_cases=sum(elderly_cases)) %>%
ungroup()
gruped_by_age_country_year <- df %>%
group_by(country, year) %>%
summarize(child_cases=sum(child_cases), adult_cases=sum(adult_cases), elderly_cases=sum(elderly_cases)) %>%
ungroup()
gruped_by_age_country_year <- df %>%
group_by(country, year) %>%
summarize(child_cases=sum(child_cases), adult_cases=sum(adult_cases), elderly_cases=sum(elderly_cases)) %>%
group_by(country)
gruped_by_age_country_year <- df %>%
group_by(country, year) %>%
summarize(child_cases=sum(child_cases), adult_cases=sum(adult_cases), elderly_cases=sum(elderly_cases))
df
gruped_by_age_country_year <- tb %>%
group_by(country, year) %>%
summarize(child_cases=sum(child_cases), adult_cases=sum(adult_cases), elderly_cases=sum(elderly_cases))
df %>%
filter(!is.na(child) & !is.na(adult) & !is.na(elderly)) %>%
group_by(year) %>%
summarise(child_cases = sum(child) / 1000, adult_cases = sum(adult) / 1000, elderly_cases = sum(elderly) / 1000)
tb %>%
filter(!is.na(child) & !is.na(adult) & !is.na(elderly)) %>%
group_by(year) %>%
summarise(child_cases = sum(child) / 1000, adult_cases = sum(adult) / 1000, elderly_cases = sum(elderly) / 1000)
df %>%
filter(!is.na(child) & !is.na(adult) & !is.na(elderly)) %>%
group_by(country, year) %>%
summarise(child_cases = sum(child) / 1000, adult_cases = sum(adult) / 1000, elderly_cases = sum(elderly) / 1000)
tb %>%
filter(!is.na(child) & !is.na(adult) & !is.na(elderly)) %>%
group_by(country, year) %>%
summarise(child_cases = sum(child) / 1000, adult_cases = sum(adult) / 1000, elderly_cases = sum(elderly) / 1000)
tb %>%
filter(!is.na(child) & !is.na(adult) & !is.na(elderly)) %>%
group_by(country, year) %>%
summarise(child_cases = sum(child), adult_cases = sum(adult), elderly_cases = sum(elderly))
library(reshape2)
install.packages("reshape2")
library(reshape2)
d <- melt(gruped_by_age_and_year, id.vars="year")
d
ggplot(d, aes(year,value, col=variable)) +
geom_point() +
stat_smooth()
ggplot(d, aes(year,value, col=variable))
ggplot(d, aes(year,value, col=variable)) +
geom_point()
ggplot(d, aes(year,value, col=variable)) +
geom_line()
ggplot(d, aes(year,value, col=Legend)) +
geom_line()
ggplot(d, aes(year,value, col=variable)) +
geom_point() +
stat_smooth()
ggplot(d, aes(year,value, col=variable)) +
geom_line()
ggplot(d, aes(year,value, col=variable)) +
geom_line() +
theme_linedraw()
ggplot(d, aes(year,value, col=variable)) +
geom_line() +
theme_linedraw()
library(reshape2)
ggplot(d, aes(year,value, col=variable)) +
geom_line() +
labs(x = "Year", y = "Cases [thousands]", color = "Legend") +
theme_linedraw()
tb %>%
filter(!is.na(child) & !is.na(adult) & !is.na(elderly)) %>%
group_by(country, year) %>%
summarise(child_cases = sum(child), adult_cases = sum(adult), elderly_cases = sum(elderly))
tb %>%
filter(!is.na(child) & !is.na(adult) & !is.na(elderly)) %>%
group_by(country, year) %>%
summarise(child_cases = sum(child), adult_cases = sum(adult), elderly_cases = sum(elderly)) %>%
group_by(country)
?invisible
?group_map
foo <- tb %>%
filter(!is.na(child) & !is.na(adult) & !is.na(elderly)) %>%
group_by(country, year) %>%
summarise(child_cases = sum(child), adult_cases = sum(adult), elderly_cases = sum(elderly)) %>%
group_by(country)
foo
foo <- tb %>%
filter(!is.na(child) & !is.na(adult) & !is.na(elderly)) %>%
group_by(country, year) %>%
summarise(child_cases = sum(child), adult_cases = sum(adult), elderly_cases = sum(elderly))
foo_d <- melt(foo, id.vars = "year")
ggplot(foo_d, aes(year,value)) +
geom_point() +
stat_smooth() +
facet_wrap(~variable)
print(ggplot(df, aes(year)) +
geom_line(aes(y = child, color = "red")) +
geom_line(aes(y = adult, color = "green")) +
geom_line(aes(y = elderly, color = "blue")) +
labs(x = "Year", y = "Cases", color = "Legend") +
scale_color_manual(labels = c("child", "adult", "elderly"),
values = c("red", "green", "blue")) +
theme_linedraw() +
scale_x_continuous(breaks = seq(min(df$year),
max(df$year), by = 2))
)
single_graph <- function(group) {
if (!is.null(group)) {
cat("\n###", as.character(group$country[1]), "\n")
}
temp <- melt(gruped_by_age_and_year, id.vars="year")
ggplot(temp, aes(year,value, col=variable)) +
geom_line() +
labs(x = "Year", y = "Cases [thousands]", color = "Legend") +
theme_linedraw()
cat("  \n")
}
foo <- df %>%
filter(!is.na(child) & !is.na(adult) & !is.na(elderly)) %>%
group_by(country, year) %>%
summarise(child_cases = sum(child), adult_cases = sum(adult), elderly_cases = sum(elderly)) %>%
group_by(country) %>%
group_map(single_graph)
foo <- tb %>%
filter(!is.na(child) & !is.na(adult) & !is.na(elderly)) %>%
group_by(country, year) %>%
summarise(child_cases = sum(child), adult_cases = sum(adult), elderly_cases = sum(elderly)) %>%
group_by(country) %>%
group_map(single_graph)
foo <- tb %>%
filter(!is.na(child) & !is.na(adult) & !is.na(elderly)) %>%
group_by(country, year) %>%
summarise(child_cases = sum(child), adult_cases = sum(adult), elderly_cases = sum(elderly)) %>%
group_by(country)
group_map(foo, single_graph)
single_graph <- function(df, group) {
if (!is.null(group)) {
cat("\n###", as.character(group$country[1]), "\n")
}
temp <- melt(gruped_by_age_and_year, id.vars="year")
ggplot(temp, aes(year,value, col=variable)) +
geom_line() +
labs(x = "Year", y = "Cases [thousands]", color = "Legend") +
theme_linedraw()
cat("  \n")
}
foo <- tb %>%
filter(!is.na(child) & !is.na(adult) & !is.na(elderly)) %>%
group_by(country, year) %>%
summarise(child_cases = sum(child), adult_cases = sum(adult), elderly_cases = sum(elderly)) %>%
group_by(country)
group_map(foo, single_graph)
library(EDAWR)
print("## " + group$country[1])
grouped_by_age_country_year
tb %>%
filter(!is.na(child) & !is.na(adult) & !is.na(elderly)) %>%
group_by(country, year) %>%
summarise(child_cases = sum(child), adult_cases = sum(adult), elderly_cases = sum(elderly)) %>%
group_by(country)
mpg
data(mpg)
mpg
library(ggplot2)
mpg
ggplot(mpg, aes(x=displ, y=hwy, color=factor(cyl))) + geom_point()
ggplot(mpg, aes(x=displ, y=hwy, color=factor(cyl))) + geom_line()
ggplot(mpg, aes(x=displ, y=hwy, color=factor(cyl))) + geom_line() + geom_point()
ggplot(mpg, aes(x=displ, y=hwy, color=factor(cyl))) + geom_line() + geom_bar(stat="identity")
ggplot(mpg, aes(x=displ, y=hwy, color=factor(cyl))) + geom_line() + geom_bar(stat="identity", position = "identity")
ggplot(mpg, aes(x=displ, y=hwy, color=factor(cyl))) + geom_bar(stat="identity", position = "identity")
ggplot(mpg, aes(x=displ, y=hwy, fill=factor(cyl))) + geom_bar(stat="identity", position = "identity")
ggplot(mpg, aes(x=displ, y=hwy, color=factor(cyl))) + geom_point()
ggplot(mpg, aes(x=displ, y=hwy, color=factor(cyl))) + geom_point() + gem_smooth()
ggplot(mpg, aes(x=displ, y=hwy, color=factor(cyl))) + geom_point() + geom_smooth()
ggplot(mpg, aes(x=displ, y=hwy, fill=factor(cyl))) + geom_point() + geom_smooth()
ggplot(mpg, aes(x=displ, y=hwy, color=factor(cyl))) + geom_point() + geom_smooth()
ggplot(mpg, aes(x=displ, y=hwy, color=factor(cyl))) + geom_point() + geom_smooth(method = "lm")
ggplot(mpg, aes(x=displ, y=hwy, color=factor(cyl))) + geom_point() + geom_smooth() + facet_grid(. ~ year)
ggplot(mpg, aes(x=displ, y=hwy) + geom_point() + geom_smooth() + facet_grid(trans ~ year)
)
ggplot(mpg, aes(x=displ, y=hwy)) + geom_point() + geom_smooth() + facet_grid(trans ~ year)
ggplot(mpg, aes(x=displ, y=hwy)) + geom_point() + geom_smooth() + facet_grid(class ~ year)
ggplot(mpg, aes(hwy, fill=drv)) +
geom_bar()
ggplot(mpg, aes(hwy, fill=drv)) + geom_bar(position = "dodge2")
ggplot(mpg, aes(hwy, fill=drv)) + geom_bar(position = "dodge")
ggplot(mpg, aes(hwy, fill=drv)) + geom_bar(position = "dodge3")
ggplot(mpg, aes(hwy, fill=drv)) + geom_bar(position = "dodge2")
ggplot(mpg, aes(hwy, fill=drv)) + geom_histogrm()
ggplot(mpg, aes(hwy, fill=drv)) + geom_histogram()
ggplot(mpg, aes(hwy, fill=drv)) + geom_density()
ggplot(mpg, aes(hwy, fill=drv, alpha=0.25)) + geom_density()
ggplot(mpg, aes(hwy, fill=drv, alpha=0.25)) + geom_density() + theme_bw()
ggplot(mpg, aes(hwy, fill=drv)) + geom_density(alpha=0.25) + theme_bw()
ggplot(mpg, aes(hwy, fill=drv)) + geom_density(alpha=0.25) + theme_dark()
ggplot(mpg, aes(hwy, fill=drv)) + geom_density(alpha=0.25) + theme_grey()
ggplot(mpg, aes(hwy, fill=drv)) + geom_density(alpha=0.25) + theme_light()
ggplot(mpg, aes(hwy, fill=drv)) + geom_density(alpha=0.25) + theme_classic()
ggplot(mpg, aes(hwy, fill=drv)) + geom_density(alpha=0.25) + theme_linedraw()
ggplot(mpg, aes(hwy, fill=drv)) + geom_density(alpha=0.25) + theme_update()
ggplot(mpg, aes(hwy, fill=drv)) + geom_density(alpha=0.25) + theme_replace()
ggplot(mpg, aes(hwy, fill=drv)) + geom_density(alpha=0.25) + theme_gray()
ggplot(mpg, aes(hwy, fill=drv)) + geom_density(alpha=0.25) + theme_grey()
ggplot(mpg, aes(hwy, fill=drv)) + geom_density(alpha=0.25) + theme_test()
ggplot(mpg, aes(hwy, fill=drv)) + geom_density(alpha=0.25) + theme_light()
depth
diamonds
ggplot(diamonds, aes(x=depth)) + geom_histogram()
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2)
ggplot(diamonds, aes(x=depth)) + geom_histogram()
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2)
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2, bins = 55:70)
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2, bins = c(55,70))
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2)
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2, xlim(55, 70))
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2, xlim(c(55, 70))
)
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2, xlim(c(55, 70)))
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2, xlim(55:70))
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2, xlim(c(55, 70)))
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2, xlim = c(55, 70))
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2) + xlim(50,70)
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2) + xlim(55,70)
ggplot(diamonds, aes(x=depth, color = cut)) + geom_histogram(binwidth = 0.2) + xlim(55,70)
ggplot(diamonds, aes(x=depth, fill = cut)) + geom_histogram(binwidth = 0.2) + xlim(55,70)
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2) + xlim(55,70) + facet_grid(. ~ cut)
ggplot(diamonds, aes(x=depth), fill = cut) + geom_histogram(binwidth = 0.2) + xlim(55,70) + facet_grid(. ~ cut)
ggplot(diamonds, aes(x=depth), fill = cut) + geom_histogram(binwidth = 0.2) + xlim(55,70) + facet_grid(. ~ cut)
ggplot(diamonds, aes(x=depth)) + geom_histogram(binwidth = 0.2) + xlim(55,70) + facet_grid(. ~ price)
;
ggplot(diamonds, aes(x=PRICE)) + geom_histogram(binwidth = 0.2) + xlim(55,70)
ggplot(diamonds, aes(x=price)) + geom_histogram(binwidth = 0.2) + xlim(55,70)
ggplot(diamonds, aes(x=price)) + geom_histogram(binwidth = 0.2
)
)
ggplot(diamonds, aes(x=price)) + geom_histogram(binwidth = 0.2)
ggplot(diamonds, aes(x=price))
diamonds
ggplot(diamonds, aes(x=factor(price))
)
ggplot(diamonds, aes(x=factor(price)))
ggplot(diamonds, aes(x=price)
)
ggplot(diamonds, aes(x=price)) + geom_histogram()
ggplot(diamonds, aes(x=price)) + geom_histogram(binwidth = 0.2)
ggplot(diamonds, aes(x=price)) + geom_histogram(binwidth = 0.8)
ggplot(diamonds, aes(x=price)) + geom_histogram(binwidth = 1)
ggplot(diamonds, aes(x=price)) + geom_histogram()
ggplot(diamonds, aes(x=price)) + geom_histogram(binwidth = 30)
ggplot(diamonds, aes(x=price)) + geom_histogram(binwidth = 30) + xlim(0, 5000)
ggplot(diamonds, aes(x=price)) + geom_histogram(binwidth = 30) + xlim(500, 5000)
ggplot(diamonds, aes(x=price, fill = cut)) + geom_histogram(binwidth = 30) + xlim(500, 5000)
ggplot(diamonds, aes(x=price, fill = cut)) + geom_histogram(binwidth = 30) + xlim(500, 5000) +facet_grid(. ~ cut)
ggplot(diamonds, aes(x=price, fill = cut)) + geom_histogram(binwidth = 30) + xlim(500, 5000) +facet_grid(. ~ cut) + coord_flip()
ggplot(diamonds, aes(x=price, fill = cut)) + geom_histogram(binwidth = 30) + xlim(500, 5000) +facet_grid(. ~ cut)
ggplot(diamonds, aes(x=price, fill = cut)) + geom_histogram(binwidth = 30) + xlim(500, 5000) +facet_grid(. ~ cut, cols = c(1, 5))
ggplot(diamonds, aes(x=price, fill = cut)) + geom_histogram(binwidth = 30) + xlim(500, 5000) +facet_grid(. ~ cut, cols = 1)
ggplot(diamonds, aes(x=price, fill = cut)) + geom_histogram(binwidth = 30) + xlim(500, 5000) +facet_grid(. ~ cut, cols = 1, rows = 5)
ggplot(diamonds, aes(x=price, fill = cut)) + geom_histogram(binwidth = 30) + xlim(500, 5000) +facet_grid(. ~ cut, as.table = c(1,5))
ggplot(diamonds, aes(x=price, fill = cut)) + geom_histogram(binwidth = 30) + xlim(500, 5000) +facet_grid(. ~ cut, as.table = c(5,1))
ggplot(diamonds, aes(x=price, fill = cut)) + geom_histogram(binwidth = 30) + xlim(500, 5000) +facet_grid(. ~ cut)
ggplot(diamonds, aes(x=price, fill = cut)) + geom_histogram(binwidth = 30) + xlim(500, 5000) +facet_wrap(. ~ cut)
ggplot(diamonds, aes(x=price, fill = cut)) + geom_histogram(binwidth = 30) + xlim(500, 5000) +facet_wrap(. ~ cut, nrow = 5)
ggplot(diamonds, aes(x=price, fill = cut)) + geom_histogram(binwidth = 30) + xlim(500, 5000) +facet_wrap(. ~ cut, nrow = 3)
library(readxl)
library(summarytools)
library(gtsummary)
library(tidyverse)
library(dplyr)
library(knitr)
library(DT)
library(ggplot2)
library(reshape2)
setWd("ZED/project/COVID-19-analysis")
setwd("ZED/project/COVID-19-analysis")
getWd()
getwd()
df <- read_excel("wuhan_blood_sample_data_Jan_Feb_2020.xlsx")
patients_df <- df %>% group_by(`Admission time`, `Discharge time`, gender, age, outcome) %>%
summarise(PATIENT_ID = sum(PATIENT_ID, na.rm = TRUE), sum_of_samples = n())
patients_df <- patients_df %>%
mutate(`Hospitalization length [days]` = ceiling(difftime(`Discharge time`, `Admission time`, units = "days")))
df <- full_join(patients_df %>% ungroup() %>% select(`Admission time`, PATIENT_ID), df %>% select(-PATIENT_ID), by="Admission time")
df$gender<-ifelse(df$gender==1, 'Male', 'Female')
df <- df %>% mutate(gender = as.factor(gender))
patients_df$gender<-ifelse(patients_df$gender==1, 'Male', 'Female')
patients_df <- patients_df %>% mutate(gender = as.factor(gender))
df$outcome<-ifelse(df$outcome==1, 'Death', 'Survival')
df <- df %>% mutate(outcome = as.factor(outcome))
patients_df$outcome<-ifelse(patients_df$outcome==1, 'Death', 'Survival')
patients_df <- patients_df %>% mutate(outcome = as.factor(outcome))
df
df
df %>% select(PATIENT_ID, `Lactate dehydrogenase`, `lymphocyte count`, `High sensitivity C-reactive protein`, outcome)
df %>% select(PATIENT_ID, `Lactate dehydrogenase`, `lymphocyte count`, `High sensitivity C-reactive protein`, outcome) %>% group_by(PATIENT_ID) %>% sumary()
df %>% select(PATIENT_ID, `Lactate dehydrogenase`, `lymphocyte count`, `High sensitivity C-reactive protein`, outcome) %>% group_by(PATIENT_ID) %>% summary()
df %>% select(PATIENT_ID, `Lactate dehydrogenase`, `lymphocyte count`, `High sensitivity C-reactive protein`, outcome) %>% group_by(PATIENT_ID) %>% summarise(LDH_count = n(`Lactate dehydrogenase`))
df %>% select(PATIENT_ID, `Lactate dehydrogenase`, `lymphocyte count`, `High sensitivity C-reactive protein`, outcome) %>% group_by(PATIENT_ID) %>% summarise(LDH_count = sum(!is.na(`Lactate dehydrogenase`))
)
df %>% ggplot(aes(x=RE_DATE, y=`Lactate dehydrogenase` fill=outcome)) + geom_line() + facet_wrap(. ~ PATIENT_ID)
df %>% ggplot(aes(x=RE_DATE, y=`Lactate dehydrogenase`)) + geom_line() + facet_wrap(. ~ PATIENT_ID)
df %>% filter(PATIENT_ID < 10) %>% ggplot(aes(x=RE_DATE, y=`Lactate dehydrogenase`)) + geom_line() + facet_wrap(. ~ PATIENT_ID)
df %>% filter(PATIENT_ID < 10) %>% ggplot(aes(x=RE_DATE, y=`Lactate dehydrogenase`, fill=outcome)) + geom_line()
df %>% filter(PATIENT_ID < 10) %>% ggplot(aes(x=RE_DATE, y=`Lactate dehydrogenase`, fill=outcome)) + geom_point()
df %>% ggplot(aes(x=RE_DATE, y=`Lactate dehydrogenase`, fill=outcome)) + geom_point()
df %>% ggplot(aes(x=RE_DATE, y=`Lactate dehydrogenase`, color=outcome)) + geom_point()
df %>% ggplot(aes(x=`Discharge time`, y=`Lactate dehydrogenase`, color=outcome)) + geom_point()
patients_df
df <- read_excel("wuhan_blood_sample_data_Jan_Feb_2020.xlsx")
patients_df <- df %>% group_by(`Admission time`, `Discharge time`, gender, age, outcome) %>%
summarise(PATIENT_ID = sum(PATIENT_ID, na.rm = TRUE), sum_of_samples = n())
patients_df <- patients_df %>%
mutate(`Days in hospital` = ceiling(difftime(`Discharge time`, `Admission time`, units = "days")))
df <- full_join(patients_df %>% ungroup() %>% select(`Admission time`, PATIENT_ID), df %>% select(-PATIENT_ID), by="Admission time")
df$gender<-ifelse(df$gender==1, 'Male', 'Female')
df <- df %>% mutate(gender = as.factor(gender))
patients_df$gender<-ifelse(patients_df$gender==1, 'Male', 'Female')
patients_df <- patients_df %>% mutate(gender = as.factor(gender))
df$outcome<-ifelse(df$outcome==1, 'Death', 'Survival')
df <- df %>% mutate(outcome = as.factor(outcome))
patients_df$outcome<-ifelse(patients_df$outcome==1, 'Death', 'Survival')
patients_df <- patients_df %>% mutate(outcome = as.factor(outcome))
patients_df
df <- read_excel("wuhan_blood_sample_data_Jan_Feb_2020.xlsx")
df
df <- read_excel("wuhan_blood_sample_data_Jan_Feb_2020.xlsx")
patients_df <- df %>% group_by(`Admission time`, `Discharge time`, gender, age, outcome) %>%
summarise(PATIENT_ID = sum(PATIENT_ID, na.rm = TRUE), `Total blood tests` = n())
patients_df <- patients_df %>%
mutate(`Days in hospital` = ceiling(difftime(`Discharge time`, `Admission time`, units = "days")))
df <- full_join(patients_df %>% ungroup() %>% select(`Admission time`, PATIENT_ID), df %>% select(-PATIENT_ID), by="Admission time")
df$gender<-ifelse(df$gender==1, 'Male', 'Female')
df <- df %>% mutate(gender = as.factor(gender))
patients_df$gender<-ifelse(patients_df$gender==1, 'Male', 'Female')
patients_df <- patients_df %>% mutate(gender = as.factor(gender))
df$outcome<-ifelse(df$outcome==1, 'Death', 'Survival')
df <- df %>% mutate(outcome = as.factor(outcome))
patients_df$outcome<-ifelse(patients_df$outcome==1, 'Death', 'Survival')
patients_df <- patients_df %>% mutate(outcome = as.factor(outcome))
ggplot(patients_df, aes(x=age,fill=gender)) + geom_histogram(binwidth = 1) + facet_grid(. ~ gender) + scale_x_continuous(name="Age", limits=c(min(df$age), max(df$age)), breaks = seq(0, 100, by=10)) + scale_y_continuous(name = "Number of patients", limits = c(0,10), breaks = seq(0,10, by=1)) +
theme_minimal()
ggplot(patients_df, aes(x=age,fill=gender)) + geom_histogram(binwidth = 1) + facet_grid(. ~ c(gender, outcome)) + scale_x_continuous(name="Age", limits=c(min(df$age), max(df$age)), breaks = seq(0, 100, by=10)) + scale_y_continuous(name = "Number of patients", limits = c(0,10), breaks = seq(0,10, by=1)) +
theme_minimal()
ggplot(patients_df, aes(x=age,fill=gender)) + geom_histogram(binwidth = 1) + facet_grid(. ~ gender) + scale_x_continuous(name="Age", limits=c(min(df$age), max(df$age)), breaks = seq(0, 100, by=10)) + scale_y_continuous(name = "Number of patients", limits = c(0,10), breaks = seq(0,10, by=1)) +
theme_minimal()
ggplot(patients_df, aes(x=age,color=outcome,fill=gender)) + geom_histogram(binwidth = 1) + facet_grid(. ~ gender) + scale_x_continuous(name="Age", limits=c(min(df$age), max(df$age)), breaks = seq(0, 100, by=10)) + scale_y_continuous(name = "Number of patients", limits = c(0,10), breaks = seq(0,10, by=1)) +
theme_minimal()
ggplot(patients_df, aes(x=age,fill=outcome)) + geom_histogram(binwidth = 1) + facet_grid(. ~ gender) + scale_x_continuous(name="Age", limits=c(min(df$age), max(df$age)), breaks = seq(0, 100, by=10)) + scale_y_continuous(name = "Number of patients", limits = c(0,10), breaks = seq(0,10, by=1)) +
theme_minimal()
ggplot(patients_df, aes(x=age,color=outcome)) + geom_histogram(binwidth = 1) + facet_grid(. ~ gender) + scale_x_continuous(name="Age", limits=c(min(df$age), max(df$age)), breaks = seq(0, 100, by=10)) + scale_y_continuous(name = "Number of patients", limits = c(0,10), breaks = seq(0,10, by=1)) +
theme_minimal()
ggplot(patients_df, aes(x=age,fill=outcome)) + geom_histogram(binwidth = 1) + facet_grid(. ~ gender) + scale_x_continuous(name="Age", limits=c(min(df$age), max(df$age)), breaks = seq(0, 100, by=10)) + scale_y_continuous(name = "Number of patients", limits = c(0,10), breaks = seq(0,10, by=1)) +
theme_minimal()
ggplot(patients_df, aes(x=age,fill=gender)) + geom_histogram(binwidth = 1) + facet_grid(outcome ~ gender) + scale_x_continuous(name="Age", limits=c(min(df$age), max(df$age)), breaks = seq(0, 100, by=10)) + scale_y_continuous(name = "Number of patients", limits = c(0,10), breaks = seq(0,10, by=1)) +
theme_minimal()
ggplot(patients_df, aes(x=age,fill=outcome)) + geom_histogram(binwidth = 1) + facet_grid(outcome ~ gender) + scale_x_continuous(name="Age", limits=c(min(df$age), max(df$age)), breaks = seq(0, 100, by=10)) + scale_y_continuous(name = "Number of patients", limits = c(0,10), breaks = seq(0,10, by=1)) +
theme_minimal()
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
tbl_summary(
patients_summary,
by = outcome,
label = gender ~ "Gender",
) %>%
add_n() %>%
add_overall() %>%
bold_labels()
patients_summary <- patients_df %>% ungroup() %>% select(-c(age, PATIENT_ID))
tbl_summary(
patients_summary,
by = outcome,
label = gender ~ "Gender",
) %>%
add_n() %>%
modify_header(label = "") %>%
add_overall() %>%
bold_labels()
ggplot(patients_df, aes(x=age,fill=gender)) + geom_histogram(binwidth = 1) + facet_grid(`Days in hospital` ~ gender) + scale_x_continuous(name="Age", limits=c(min(df$age), max(df$age)), breaks = seq(0, 100, by=10)) + scale_y_continuous(name = "Number of patients", limits = c(0,10), breaks = seq(0,10, by=1)) +
theme_minimal()
)
ggplot(patients_df, aes(x=age,fill=factor(`Total blood tests`))) + geom_histogram(binwidth = 1) + facet_grid(`Days in hospital` ~ outcome) + scale_x_continuous(name="Age", limits=c(min(df$age), max(df$age)), breaks = seq(0, 100, by=10)) + scale_y_continuous(name = "Number of patients", limits = c(0,10), breaks = seq(0,10, by=1)) +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`,fill=factor(`Total blood tests`))) + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome) +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`, y=`Total blood tests`)) + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome) +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`, y=`Total blood tests`)) + geom_point() + facet_grid(. ~ outcome) +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`, y=`Total blood tests`, color=outcome)) + geom_point() + facet_grid(. ~ gender) +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`, y=`Total blood tests`, color=outcome)) + geom_point() + facet_grid(. ~ gender) + geom_smooth() +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`, y=`Total blood tests`, color=outcome)) + geom_point() + facet_grid(. ~ gender) + geom_smooth(method = "lm") +
theme_minimal()
ggplot(patients_df, aes(x=age,fill=gender)) + geom_histogram(binwidth = 1) + facet_grid(`Days in hospital` ~ gender) + scale_x_continuous(name="Age", limits=c(min(df$age), max(df$age)), breaks = seq(0, 100, by=10)) + scale_y_continuous(name = "Number of patients", limits = c(0,10), breaks = seq(0,10, by=1)) +
theme_minimal()
;
ggplot(patients_df, aes(x=age,fill=outcome)) + geom_histogram(binwidth = 1) + facet_grid(outcome ~ gender) + scale_x_continuous(name="Age", limits=c(min(df$age), max(df$age)), breaks = seq(0, 100, by=10)) + scale_y_continuous(name = "Number of patients", limits = c(0,9), breaks = seq(0,9, by=1)) +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`,fill=outcome)) + geom_histogram(binwidth = 1) + facet_grid(outcome ~ gender)  +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`,fill=gender)) + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome)  +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`,fill=gender)) + geom_histogram(binwidth = 1) + facet_grid(gender ~ outcome)  +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`)) + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome)  +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`), fill="red") + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome)  +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`), fill=outcome) + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome)  +
theme_minimal()
ggplot(patients_df, aes(x=as.integer(`Days in hospital`), fill=outcome) + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome)  +
theme_minimal()
;
;
ggplot(patients_df, aes(x=as.integer(`Days in hospital`)), fill=outcome) + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome)  +
theme_minimal()
ggplot(patients_df, aes(x=as.integer(`Days in hospital`)), color=outcome) + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome)  +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`), color=outcome) + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome)  +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`), fill=outcome) + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome)  +
theme_minimal()
ggplot(patients_df, aes(x=`Days in hospital`, fill=outcome)) + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome)  + ylab("Number of patients") +
theme_minimal()
mod1 <- glm(outcome ~ age + gender + `Days in hospital`, patients_df, family = binomial)
tbl_regression(mod1, exponentiate = TRUE)
mod1 <- glm(outcome ~ `Days in hospital`, patients_df, family = binomial)
tbl_regression(mod1, exponentiate = TRUE)
ggplot(patients_df, aes(x=`Total blood tests`, fill=outcome)) + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome)  + ylab("Number of patients") +
theme_minimal()
ggplot(patients_df, aes(x=`Total blood tests`, fill=outcome)) + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome)  + ylab("Number of patients") +
scale_y_continuous(name = "Number of patients", limits = c(0,20), breaks = seq(0,20, by=2)) +
theme_minimal()
ggplot(patients_df, aes(x=`Total blood tests`, fill=outcome)) + geom_histogram(binwidth = 1) + facet_grid(. ~ outcome)  + ylab("Number of patients") +
scale_x_continuous(name="Total blood tests", limits=c(0, 60), breaks = seq(0, 60, by=10)) +
scale_y_continuous(name = "Number of patients", limits = c(0,20), breaks = seq(0,20, by=2)) +
theme_minimal()
df %>% group_by(PATIENT_ID)
df %>% group_by(PATIENT_ID) %>% fill(`Lactate dehydrogenase`)
df %>% group_by(PATIENT_ID) %>% fill(`Lactate dehydrogenase`) %>% summarise(LDH=`Lactate dehydrogenase`)
df %>% filter(!is.na(`Lactate dehydrogenase`))
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% group_by(PATIENT_ID) %>% summarise(notNA = n())
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% group_by(PATIENT_ID) %>% summarise(notNA = n()) %>% arragne(desc(notNA))
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% group_by(PATIENT_ID) %>% summarise(notNA = n()) %>% arrange(desc(notNA))
df %>% group_by(PATIENT_ID) %>% summarise(countALL = n(), `Lactate dehydrogenase`) %>% filter(!is.na(`Lactate dehydrogenase`)) %>% group_by(PATIENT_ID) %>% summarise(notNA = n()) %>% arrange(desc(notNA))
df %>% group_by(PATIENT_ID) %>% summarise(countALL = n(), `Lactate dehydrogenase`) %>% filter(!is.na(`Lactate dehydrogenase`)) %>% group_by(PATIENT_ID) %>% summarise(all = countALL, notNA = n()) %>% arrange(desc(notNA))
df %>% group_by(PATIENT_ID) %>% summarise(countALL = n(), `Lactate dehydrogenase`) %>% filter(!is.na(`Lactate dehydrogenase`)) %>% group_by(PATIENT_ID) %>% summarise(notNA = n()) %>% arrange(desc(notNA))
df %>% group_by(PATIENT_ID) %>% summarise(countALL = n(), `Lactate dehydrogenase`) %>% filter(!is.na(`Lactate dehydrogenase`))
df %>% filter(!is.na(`Lactate dehydrogenase`))
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% group_by(PATIENT_ID) %>% summarise(n())
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% group_by(PATIENT_ID)
df %>% filter(!is.na(`Lactate dehydrogenase`))
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot()
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(aes(x = RE_DATE, y=`Lactate dehydrogenase`)) + geom_point()
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(aes(x = RE_DATE, y=`Lactate dehydrogenase`, fill=outcome)) + geom_point()
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(aes(x = PATIENT_ID, y=`Lactate dehydrogenase`, fill=outcome)) + geom_point()
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(aes(x = PATIENT_ID, y=`Lactate dehydrogenase`, color=outcome)) + geom_point()
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(aes(x = RE_DATE, y=`Lactate dehydrogenase`, color=outcome)) + geom_point()
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(aes( y=`Lactate dehydrogenase`, color=outcome)) + geom_point()
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(aes(x=n() y=`Lactate dehydrogenase`, color=outcome)) + geom_point()
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(aes(x = RE_DATE, y=`Lactate dehydrogenase`, color=outcome)) + geom_point()
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(aes(x = RE_DATE, y=`Lactate dehydrogenase`, color=outcome)) + geom_point() + geom_line()
df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(aes(x = RE_DATE, y=`Lactate dehydrogenase`, color=outcome)) + geom_point()
library(ggplot2)
library(gganimate)
library(gapminder)
install.packages("gganimate")
install.packages("gapminder")
g <- df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(gapminder, aes(x = RE_DATE, y=`Lactate dehydrogenase`, frame=PATIENT_ID ,color=outcome)) + geom_point() + geom_line()
library(gganimate)
library(gapminder)
g <- df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(gapminder, aes(x = RE_DATE, y=`Lactate dehydrogenase`, frame=PATIENT_ID ,color=outcome)) + geom_point() + geom_line()
g <- df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(aes(x = RE_DATE, y=`Lactate dehydrogenase`, frame=PATIENT_ID ,color=outcome)) + geom_point() + geom_line()
gganimate(g, interval=0.2)
install.packages("cowplot")
devtools::install_github("dgrtwo/gganimate")
library(ggplot2)
library(gganimate)
library(gapminder)
g <- df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(aes(x = RE_DATE, y=`Lactate dehydrogenase`, frame=PATIENT_ID ,color=outcome)) + geom_point() + geom_line()
gganimate(g, interval=0.2)
devtools::install_github('thomasp85/gganimate/releases/tag/v0.1.1', force = TRUE)
gganimate(g)
g + transition_events()
g
g <- df %>% filter(!is.na(`Lactate dehydrogenase`)) %>% ggplot(aes(x = RE_DATE, y=`Lactate dehydrogenase`, frame=PATIENT_ID ,color=outcome)) + geom_point() + geom_line()
g + transition_time(PATIENT_ID)
